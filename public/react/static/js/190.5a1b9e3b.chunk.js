"use strict";(self.webpackChunkreact_src=self.webpackChunkreact_src||[]).push([[190],{2190:function(e,n,r){r.r(n),r.d(n,{default:function(){return R}});var t=r(4165),o=r(1413),a=r(5861),c=r(3098),s=[{value:"project",label:(0,c.__)("Project")},{value:"global",label:(0,c.__)("Global")},{value:"workspace",label:(0,c.__)("Workspace")}],l=[{value:"custom",label:(0,c.__)("Custom")},{value:"standard",label:(0,c.__)("Standard")}],i=r(279),u="RoleEdit_dFlex__VHCo6",d="RoleEdit_placeEnd__8t5HP",f="RoleEdit_mt4__NPhPp",p="RoleEdit_gap1__E2Q2H",h="RoleEdit_w200px__Ug95D",v=r(4942),m=r(885),b=r(390);var x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=(0,b.useState)({id:e,name:"",scope:"",projectId:"",type:"",createdDate:"",createdBy:"",lastModifiedDate:"",lastModifiedBy:""}),r=(0,m.Z)(n,2),c=r[0],s=r[1],l=(0,b.useState)({}),u=(0,m.Z)(l,2),d=u[0],f=u[1];return(0,b.useEffect)((function(){function n(){return n=(0,a.Z)((0,t.Z)().mark((function n(){var r,o,a,c;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,i.fp)(e);case 2:a=n.sent,c={id:a.id,name:a.name,scope:a.scope,projectId:a.project_id||"",type:a.type||"",createdDate:a.created_date,createdBy:(null===(r=a.creatorUserInfo)||void 0===r?void 0:r.name)||"",lastModifiedDate:a.last_modified_date,lastModifiedBy:(null===(o=a.updaterUserInfo)||void 0===o?void 0:o.name)||""},s(c);case 5:case"end":return n.stop()}}),n)}))),n.apply(this,arguments)}e&&function(){return n.apply(this,arguments)}().then((function(){})).catch((function(e){console.log(e)}))}),[e]),{roleData:c,setRoleProperty:function(e,n){var r=(0,o.Z)({},c);"type"===e&&"custom"!==n&&(r.projectId=""),s((0,o.Z)((0,o.Z)({},r),{},(0,v.Z)({},e,n)))},validateRole:function(){var e={};return c.name||(e.name="Role name is required"),c.scope&&["global","project","workspace"].includes(c.scope)||(e.scope="Role scope is required and must be one of: global, project, workspace"),c.type&&["standard","custom"].includes(c.type)||(e.type="Role type is required and must be one of: standard, custom"),c.projectId||"custom"!==c.type||(e.projectId="Project is required when scope is project and type is custom"),f(e),0===Object.keys(e).length},roleErrors:d}},j=r(907);var y=r(181);function _(e){return function(e){if(Array.isArray(e))return(0,j.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,y.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=function(e){var n=(0,b.useState)([]),r=(0,m.Z)(n,2),o=r[0],c=r[1];(0,b.useEffect)((function(){function n(){return(n=(0,a.Z)((0,t.Z)().mark((function n(){var r,o,a;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,i.qg)();case 2:return r=n.sent,n.next=5,(0,i.GI)(e);case 5:o=n.sent,a=r.map((function(e){return{value:e.code,label:e.name,parent:e.parent,checked:!!o.find((function(n){return n.permission_code===e.code}))}})),c(a);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}(function(){return n.apply(this,arguments)})().then((function(){})).catch((function(e){console.log(e)}))}),[e]);return{rolesPermissions:o,setRolesPermissions:c,updatePermissionInRole:function(e,n){var r=_(o),t=r.findIndex((function(n){return n.value===e}));r[t].checked=n,c(r)},updateAllChildren:function(e,n){var r=_(o);r.filter((function(n){return n.parent===e})).forEach((function(e){var t=r.findIndex((function(n){return n.value===e.value}));r[t].checked=n})),c(r)}}},Z=function(){var e=(0,b.useState)([]),n=(0,m.Z)(e,2),r=n[0],o=n[1];return(0,b.useEffect)((function(){(0,a.Z)((0,t.Z)().mark((function e(){var n,r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.bl)();case 2:n=e.sent,r=n.map((function(e){var n=e.primary_language;return{label:e.i18n.title[n],value:e.id}})),o(r);case 5:case"end":return e.stop()}}),e)})))()}),[]),{projects:r}},w=r(1557),k=r(9692),S=r(1119),C=r(2559),N=function(e){var n=e.options,r=e.onChange,t=e.changeChildren,o=(0,b.useState)([]),a=(0,m.Z)(o,2),c=a[0],s=a[1];return(0,b.useEffect)((function(){var e=[];n.forEach((function(n){!1===e.includes(n.parent)&&e.push(n.parent)})),s(e.sort((function(e,n){return e.localeCompare(n,"en",{sensitivity:"base"})})))}),[n]),(0,C.jsx)(C.Fragment,{children:c.map((function(e){return(0,C.jsxs)("div",{className:"form-horizontal form-group align-baseline w-90",children:[(0,C.jsxs)("div",{className:"form-group col-md-3",children:[(0,C.jsx)("input",{onChange:function(n){return t(e,n.target.checked)},type:"checkbox"}),(0,C.jsx)("label",{className:"control-label ml-2",children:e})]}),(0,C.jsx)("div",{className:"form-group col-md-9",children:n.map((function(n){if(n.parent===e)return(0,C.jsxs)("div",{children:[(0,C.jsx)("input",{value:n.value,type:"checkbox",checked:n.checked,onChange:function(e){return r(n.value,!n.checked)}}),(0,C.jsx)("label",{style:{fontStyle:"14px",marginLeft:"4px"},children:n.label})]},n.value)}))})]},e)}))})},I=r(1619),R=function(e){var n=e.roleId,r=void 0===n?0:n,v=x(r),m=v.roleData,b=v.setRoleProperty,j=v.validateRole,y=v.roleErrors,_=g(r),R=_.rolesPermissions,E=(_.setRolesPermissions,_.updatePermissionInRole),P=_.updateAllChildren,O=Z().projects,U=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var n,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j()){e.next=2;break}return e.abrupt("return");case 2:return n=R.filter((function(e){return e.checked})),a=(0,o.Z)((0,o.Z)({},m),{},{permissions:n}),e.next=6,(0,i.hw)(r,a);case 6:e.sent.ok&&(window.location.href="../../role");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,C.jsxs)(C.Fragment,{children:[0!==Number(r)?(0,C.jsx)("h2",{children:(0,c.__)("Roles Edit")}):(0,C.jsx)("h2",{children:(0,c.__)("Roles Create")}),(0,C.jsx)(w.Z,{label:(0,c.__)("Role name"),hasStar:!0,error:null===y||void 0===y?void 0:y.name,children:(0,C.jsx)(k.Z,{className:"form-control",value:m.name,onChange:function(e){return b("name",e.target.value)}})}),(0,C.jsx)(w.Z,{label:(0,c.__)("Scope"),hasStar:!0,error:null===y||void 0===y?void 0:y.scope,children:(0,C.jsx)(S.Z,{className:"form-control",value:m.scope,options:s,onChange:function(e){return b("scope",e.target.value)}})}),(0,C.jsx)(w.Z,{label:(0,c.__)("Type"),hasStar:!0,error:null===y||void 0===y?void 0:y.type,children:(0,C.jsx)(S.Z,{className:"form-control",options:l,value:m.type,onChange:function(e){return b("type",e.target.value)}})}),O.length>0&&"custom"===m.type&&(0,C.jsx)(w.Z,{label:(0,c.__)("Custom role project"),hasStar:!0,error:null===y||void 0===y?void 0:y.projectId,children:(0,C.jsx)(S.Z,{className:"form-control",options:O,value:m.projectId,onChange:function(e){return b("projectId",e.target.value)}})})||null,(0,C.jsx)("br",{}),(0,C.jsx)("br",{}),(0,C.jsx)(w.Z,{label:(0,c.__)("Created on"),children:(0,C.jsx)(k.Z,{className:"form-control",value:m.createdDate,disabled:!0})}),(0,C.jsx)(w.Z,{label:(0,c.__)("Created by"),children:(0,C.jsx)(k.Z,{className:"form-control",value:m.createdBy,disabled:!0})}),(0,C.jsx)(w.Z,{label:(0,c.__)("Last modified on"),children:(0,C.jsx)(k.Z,{className:"form-control",value:m.lastModifiedDate,disabled:!0})}),(0,C.jsx)(w.Z,{label:(0,c.__)("Last modified by"),children:(0,C.jsx)(k.Z,{className:"form-control",value:m.lastModifiedBy,disabled:!0})}),(0,C.jsx)("h2",{className:"mt-3",children:(0,c.__)("Permissions")}),(0,C.jsx)("div",{className:"container-scrollable-700x400",children:(0,C.jsx)(N,{options:R,changeChildren:P,onChange:E})}),(0,C.jsxs)("div",{className:"".concat(u," ").concat(p," ").concat(f," ").concat(d),children:[(0,C.jsx)(I.Z,{buttons:[{label:(0,c.__)("Cancel"),class:"btn btn-secondary ".concat(h),onClick:function(){return window.location.href="../../role"}}]}),(0,C.jsx)(I.Z,{buttons:[{label:(0,c.__)("Save changes"),class:"btn btn-default ".concat(h),onClick:U}]})]})]})}},1119:function(e,n,r){r.d(n,{Z:function(){return l}});var t=r(1413);function o(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}r(390);var a=r(3098),c=r(2559),s=["options","value"],l=function(e){var n=e.options,r=void 0===n?[]:n,l=e.value,i=o(e,s);return Array.isArray(r)||(console.error("DropdownInput received non-array options:",r),r=[]),0===r.length?(0,c.jsx)(c.Fragment,{}):(0,c.jsxs)("select",(0,t.Z)((0,t.Z)({value:l},i),{},{children:[!l&&(0,c.jsx)("option",{value:"",children:(0,a.__)("Select an option")}),r.map((function(e){return(0,c.jsx)("option",{value:e.value,children:e.label},e.value)}))]}))}},1619:function(e,n,r){r(390);var t=r(2559);n.Z=function(e){var n=e.buttons,r=void 0===n?[]:n;return(0,t.jsx)("div",{className:"ButtonGroup",children:r.map((function(e,n){return(0,t.jsx)("button",{type:"button",className:e.class,onClick:e.onClick,children:e.label},n)}))})}},1557:function(e,n,r){r.d(n,{Z:function(){return o}});r(390);var t=r(2559),o=function(e){var n=e.label,r=e.hasStar,o=void 0!==r&&r,a=e.error,c=e.children;return(0,t.jsxs)("div",{className:"form-group highlight-addon row",children:[(0,t.jsx)("div",{className:"form-group col-md-3",children:n&&(0,t.jsx)("label",{className:"control-label ".concat(o?"has-star":""),children:n})}),(0,t.jsx)("div",{className:"form-group col-md-5",children:c}),a&&(0,t.jsx)("div",{className:"col-12 help-block help-block-error",children:a})]})}},9692:function(e,n,r){var t=r(1413),o=(r(390),r(2559));n.Z=function(e){return(0,o.jsx)("input",(0,t.Z)({type:"text"},e))}},279:function(e,n,r){r.d(n,{GI:function(){return u},N8:function(){return d},bl:function(){return s},fp:function(){return l},hw:function(){return a},qg:function(){return i},vd:function(){return c}});var t=r(7787),o=window.HERAMS_PROXY_API_URL||"".concat(window.location.origin,"/api-proxy/core"),a=function(e,n){return(0,t.v)("".concat(o,"/roles/").concat(e,"/update"),n)},c=function(e,n){return(0,t.U)("".concat(o,"/roles/index"),e,n)},s=function(e,n){return(0,t.U)("".concat(o,"/projects"),e,n)},l=function(e,n,r){return(0,t.U)("".concat(o,"/roles/").concat(e,"/view"),n,r)},i=function(e,n){return(0,t.U)("".concat(o,"/permissions/index"),e,n)},u=function(e,n,r){return(0,t.U)("".concat(o,"/roles/").concat(e,"/permissions"),n,r)},d=function(e,n,r){return(0,t.U)("".concat(o,"/roles/").concat(e,"/delete"),n,r)}},7787:function(e,n,r){r.d(n,{U:function(){return s},v:function(){return l}});var t=r(4165),o=r(1413),a=r(5861);function c(){var e=document.querySelector('meta[name="csrf-token"]');return e?e.getAttribute("content"):null}var s=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n){var r,a,c,s,l=arguments;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:{},a=l.length>2&&void 0!==l[2]?l[2]:{},c=new URL(n),Object.keys(r).forEach((function(e){return c.searchParams.append(e,r[e])})),e.next=6,fetch(c,{method:"GET",headers:(0,o.Z)({"Content-Type":"application/json"},a)});case 6:return s=e.sent,e.abrupt("return",i(s));case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n,r){var o;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":c(),"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(r)});case 3:if((o=e.sent).ok){e.next=6;break}throw new Error("Server responded with status: ".concat(o.status));case 6:return e.abrupt("return",o);case 9:throw e.prev=9,e.t0=e.catch(0),console.error("Error during POST request:",e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,r){return e.apply(this,arguments)}}(),i=function(e){if(!e.ok)throw new Error("Network response was not ok");return e.json()}},3098:function(e,n,r){r.d(n,{Hh:function(){return o},Lb:function(){return a},__:function(){return c}});var t="translations",o=function(e){try{var n=JSON.stringify(e);localStorage.setItem(t,n)}catch(r){console.error("Failed to save translations to localStorage:",r)}},a=function(){try{localStorage.removeItem(t)}catch(e){console.error("Failed to clear translations from localStorage:",e)}},c=function(e){try{var n=localStorage.getItem(t);return n&&JSON.parse(n)[e]||e}catch(r){return console.error("Failed to retrieve translation from localStorage:",r),null}}}}]);
//# sourceMappingURL=190.5a1b9e3b.chunk.js.map